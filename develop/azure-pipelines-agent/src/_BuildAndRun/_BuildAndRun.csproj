<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>netcoreapp3.1</TargetFramework>
  </PropertyGroup>
	<PropertyGroup>
		<PowerShellExe Condition=" '$(PowerShellExe)'=='' ">%WINDIR%\System32\WindowsPowerShell\v1.0\powershell.exe</PowerShellExe>
		<ScriptLocation Condition=" '$(ScriptLocation)'=='' ">..\..\StartHere\Scripts\HostedAgent.ps1</ScriptLocation>
		<AssemblyVersion>1.0.0.60</AssemblyVersion>
	</PropertyGroup>
	<ItemGroup>
	  <Folder Include="ConfigFiles\" />
		<ConfigFiles Include="ConfigFiles\*.*" />
	</ItemGroup>

	<Target Name="PreBuild" BeforeTargets="PreBuildEvent">
		<Message Text="Building agent" Importance="high" />
		<Exec Command="$(PowerShellExe) -NonInteractive -executionpolicy Unrestricted -command &quot;&amp; { $(ScriptLocation) } &quot;" LogStandardErrorAsError="True" ContinueOnError="True" WorkingDirectory="$(MSBuildProjectDirectory)" />
		<Copy SourceFiles="@(ConfigFiles)" DestinationFolder="$(ProjectDir)..\..\_layout\win-x64" />
	</Target>

</Project>
